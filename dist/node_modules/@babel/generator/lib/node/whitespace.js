"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.list = exports.nodes = void 0;

function t() {
  const data = _interopRequireWildcard(require("@babel/types"));

  t = function () {
    return data;
  };

  return data;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};

    if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) {
          var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};

          if (desc.get || desc.set) {
            Object.defineProperty(newObj, key, desc);
          } else {
            newObj[key] = obj[key];
          }
        }
      }
    }

    newObj.default = obj;
    return newObj;
  }
}

function crawl(node, state = {}) {
  if (t().isMemberExpression(node)) {
    crawl(node.object, state);
    if (node.computed) crawl(node.property, state);
  } else if (t().isBinary(node) || t().isAssignmentExpression(node)) {
    crawl(node.left, state);
    crawl(node.right, state);
  } else if (t().isCallExpression(node)) {
    state.hasCall = true;
    crawl(node.callee, state);
  } else if (t().isFunction(node)) {
    state.hasFunction = true;
  } else if (t().isIdentifier(node)) {
    state.hasHelper = state.hasHelper || isHelper(node.callee);
  }

  return state;
}

function isHelper(node) {
  if (t().isMemberExpression(node)) {
    return isHelper(node.object) || isHelper(node.property);
  } else if (t().isIdentifier(node)) {
    return node.name === "require" || node.name[0] === "_";
  } else if (t().isCallExpression(node)) {
    return isHelper(node.callee);
  } else if (t().isBinary(node) || t().isAssignmentExpression(node)) {
    return t().isIdentifier(node.left) && isHelper(node.left) || isHelper(node.right);
  } else {
    return false;
  }
}

function isType(node) {
  return t().isLiteral(node) || t().isObjectExpression(node) || t().isArrayExpression(node) || t().isIdentifier(node) || t().isMemberExpression(node);
}

const nodes = {
  AssignmentExpression(node) {
    const state = crawl(node.right);

    if (state.hasCall && state.hasHelper || state.hasFunction) {
      return {
        before: state.hasFunction,
        after: true
      };
    }
  },

  SwitchCase(node, parent) {
    return {
      before: node.consequent.length || parent.cases[0] === node,
      after: !node.consequent.length && parent.cases[parent.cases.length - 1] === node
    };
  },

  LogicalExpression(node) {
    if (t().isFunction(node.left) || t().isFunction(node.right)) {
      return {
        after: true
      };
    }
  },

  Literal(node) {
    if (node.value === "use strict") {
      return {
        after: true
      };
    }
  },

  CallExpression(node) {
    if (t().isFunction(node.callee) || isHelper(node)) {
      return {
        before: true,
        after: true
      };
    }
  },

  VariableDeclaration(node) {
    for (let i = 0; i < node.declarations.length; i++) {
      const declar = node.declarations[i];
      let enabled = isHelper(declar.id) && !isType(declar.init);

      if (!enabled) {
        const state = crawl(declar.init);
        enabled = isHelper(declar.init) && state.hasCall || state.hasFunction;
      }

      if (enabled) {
        return {
          before: true,
          after: true
        };
      }
    }
  },

  IfStatement(node) {
    if (t().isBlockStatement(node.consequent)) {
      return {
        before: true,
        after: true
      };
    }
  }

};
exports.nodes = nodes;

nodes.ObjectProperty = nodes.ObjectTypeProperty = nodes.ObjectMethod = function (node, parent) {
  if (parent.properties[0] === node) {
    return {
      before: true
    };
  }
};

nodes.ObjectTypeCallProperty = function (node, parent) {
  if (parent.callProperties[0] === node && (!parent.properties || !parent.properties.length)) {
    return {
      before: true
    };
  }
};

nodes.ObjectTypeIndexer = function (node, parent) {
  if (parent.indexers[0] === node && (!parent.properties || !parent.properties.length) && (!parent.callProperties || !parent.callProperties.length)) {
    return {
      before: true
    };
  }
};

nodes.ObjectTypeInternalSlot = function (node, parent) {
  if (parent.internalSlots[0] === node && (!parent.properties || !parent.properties.length) && (!parent.callProperties || !parent.callProperties.length) && (!parent.indexers || !parent.indexers.length)) {
    return {
      before: true
    };
  }
};

const list = {
  VariableDeclaration(node) {
    return node.declarations.map(decl => decl.init);
  },

  ArrayExpression(node) {
    return node.elements;
  },

  ObjectExpression(node) {
    return node.properties;
  }

};
exports.list = list;
[["Function", true], ["Class", true], ["Loop", true], ["LabeledStatement", true], ["SwitchStatement", true], ["TryStatement", true]].forEach(function ([type, amounts]) {
  if (typeof amounts === "boolean") {
    amounts = {
      after: amounts,
      before: amounts
    };
  }

  [type].concat(t().FLIPPED_ALIAS_KEYS[type] || []).forEach(function (type) {
    nodes[type] = function () {
      return amounts;
    };
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9AYmFiZWwvZ2VuZXJhdG9yL2xpYi9ub2RlL3doaXRlc3BhY2UuanMiXSwibmFtZXMiOlsiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJsaXN0Iiwibm9kZXMiLCJ0IiwiZGF0YSIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwicmVxdWlyZSIsIm9iaiIsIl9fZXNNb2R1bGUiLCJuZXdPYmoiLCJrZXkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJkZXNjIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZ2V0Iiwic2V0IiwiZGVmYXVsdCIsImNyYXdsIiwibm9kZSIsInN0YXRlIiwiaXNNZW1iZXJFeHByZXNzaW9uIiwib2JqZWN0IiwiY29tcHV0ZWQiLCJwcm9wZXJ0eSIsImlzQmluYXJ5IiwiaXNBc3NpZ25tZW50RXhwcmVzc2lvbiIsImxlZnQiLCJyaWdodCIsImlzQ2FsbEV4cHJlc3Npb24iLCJoYXNDYWxsIiwiY2FsbGVlIiwiaXNGdW5jdGlvbiIsImhhc0Z1bmN0aW9uIiwiaXNJZGVudGlmaWVyIiwiaGFzSGVscGVyIiwiaXNIZWxwZXIiLCJuYW1lIiwiaXNUeXBlIiwiaXNMaXRlcmFsIiwiaXNPYmplY3RFeHByZXNzaW9uIiwiaXNBcnJheUV4cHJlc3Npb24iLCJBc3NpZ25tZW50RXhwcmVzc2lvbiIsImJlZm9yZSIsImFmdGVyIiwiU3dpdGNoQ2FzZSIsInBhcmVudCIsImNvbnNlcXVlbnQiLCJsZW5ndGgiLCJjYXNlcyIsIkxvZ2ljYWxFeHByZXNzaW9uIiwiTGl0ZXJhbCIsIkNhbGxFeHByZXNzaW9uIiwiVmFyaWFibGVEZWNsYXJhdGlvbiIsImkiLCJkZWNsYXJhdGlvbnMiLCJkZWNsYXIiLCJlbmFibGVkIiwiaWQiLCJpbml0IiwiSWZTdGF0ZW1lbnQiLCJpc0Jsb2NrU3RhdGVtZW50IiwiT2JqZWN0UHJvcGVydHkiLCJPYmplY3RUeXBlUHJvcGVydHkiLCJPYmplY3RNZXRob2QiLCJwcm9wZXJ0aWVzIiwiT2JqZWN0VHlwZUNhbGxQcm9wZXJ0eSIsImNhbGxQcm9wZXJ0aWVzIiwiT2JqZWN0VHlwZUluZGV4ZXIiLCJpbmRleGVycyIsIk9iamVjdFR5cGVJbnRlcm5hbFNsb3QiLCJpbnRlcm5hbFNsb3RzIiwibWFwIiwiZGVjbCIsIkFycmF5RXhwcmVzc2lvbiIsImVsZW1lbnRzIiwiT2JqZWN0RXhwcmVzc2lvbiIsImZvckVhY2giLCJ0eXBlIiwiYW1vdW50cyIsImNvbmNhdCIsIkZMSVBQRURfQUxJQVNfS0VZUyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUFBLE1BQU0sQ0FBQ0MsY0FBUCxDQUFzQkMsT0FBdEIsRUFBK0IsWUFBL0IsRUFBNkM7QUFDM0NDLEVBQUFBLEtBQUssRUFBRTtBQURvQyxDQUE3QztBQUdBRCxPQUFPLENBQUNFLElBQVIsR0FBZUYsT0FBTyxDQUFDRyxLQUFSLEdBQWdCLEtBQUssQ0FBcEM7O0FBRUEsU0FBU0MsQ0FBVCxHQUFhO0FBQ1gsUUFBTUMsSUFBSSxHQUFHQyx1QkFBdUIsQ0FBQ0MsT0FBTyxDQUFDLGNBQUQsQ0FBUixDQUFwQzs7QUFFQUgsRUFBQUEsQ0FBQyxHQUFHLFlBQVk7QUFDZCxXQUFPQyxJQUFQO0FBQ0QsR0FGRDs7QUFJQSxTQUFPQSxJQUFQO0FBQ0Q7O0FBRUQsU0FBU0MsdUJBQVQsQ0FBaUNFLEdBQWpDLEVBQXNDO0FBQUUsTUFBSUEsR0FBRyxJQUFJQSxHQUFHLENBQUNDLFVBQWYsRUFBMkI7QUFBRSxXQUFPRCxHQUFQO0FBQWEsR0FBMUMsTUFBZ0Q7QUFBRSxRQUFJRSxNQUFNLEdBQUcsRUFBYjs7QUFBaUIsUUFBSUYsR0FBRyxJQUFJLElBQVgsRUFBaUI7QUFBRSxXQUFLLElBQUlHLEdBQVQsSUFBZ0JILEdBQWhCLEVBQXFCO0FBQUUsWUFBSVYsTUFBTSxDQUFDYyxTQUFQLENBQWlCQyxjQUFqQixDQUFnQ0MsSUFBaEMsQ0FBcUNOLEdBQXJDLEVBQTBDRyxHQUExQyxD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QSxNQUFNLEVBQUVvQztBQUZBLEtBQVY7QUFJRDs7QUFFRCxHQUFDRCxJQUFELEVBQU9FLE1BQVAsQ0FBYzlFLENBQUMsR0FBRytFLGtCQUFKLENBQXVCSCxJQUF2QixLQUFnQyxFQUE5QyxFQUFrREQsT0FBbEQsQ0FBMEQsVUFBVUMsSUFBVixFQUFnQjtBQUN4RTdFLElBQUFBLEtBQUssQ0FBQzZFLElBQUQsQ0FBTCxHQUFjLFlBQVk7QUFDeEIsYUFBT0MsT0FBUDtBQUNELEtBRkQ7QUFHRCxHQUpEO0FBS0QsQ0FiRCIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5saXN0ID0gZXhwb3J0cy5ub2RlcyA9IHZvaWQgMDtcblxuZnVuY3Rpb24gdCgpIHtcbiAgY29uc3QgZGF0YSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoXCJAYmFiZWwvdHlwZXNcIikpO1xuXG4gIHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH07XG5cbiAgcmV0dXJuIGRhdGE7XG59XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307IGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOyB9IGVsc2UgeyBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH1cblxuZnVuY3Rpb24gY3Jhd2wobm9kZSwgc3RhdGUgPSB7fSkge1xuICBpZiAodCgpLmlzTWVtYmVyRXhwcmVzc2lvbihub2RlKSkge1xuICAgIGNyYXdsKG5vZGUub2JqZWN0LCBzdGF0ZSk7XG4gICAgaWYgKG5vZGUuY29tcHV0ZWQpIGNyYXdsKG5vZGUucHJvcGVydHksIHN0YXRlKTtcbiAgfSBlbHNlIGlmICh0KCkuaXNCaW5hcnkobm9kZSkgfHwgdCgpLmlzQXNzaWdubWVudEV4cHJlc3Npb24obm9kZSkpIHtcbiAgICBjcmF3bChub2RlLmxlZnQsIHN0YXRlKTtcbiAgICBjcmF3bChub2RlLnJpZ2h0LCBzdGF0ZSk7XG4gIH0gZWxzZSBpZiAodCgpLmlzQ2FsbEV4cHJlc3Npb24obm9kZSkpIHtcbiAgICBzdGF0ZS5oYXNDYWxsID0gdHJ1ZTtcbiAgICBjcmF3bChub2RlLmNhbGxlZSwgc3RhdGUpO1xuICB9IGVsc2UgaWYgKHQoKS5pc0Z1bmN0aW9uKG5vZGUpKSB7XG4gICAgc3RhdGUuaGFzRnVuY3Rpb24gPSB0cnVlO1xuICB9IGVsc2UgaWYgKHQoKS5pc0lkZW50aWZpZXIobm9kZSkpIHtcbiAgICBzdGF0ZS5oYXNIZWxwZXIgPSBzdGF0ZS5oYXNIZWxwZXIgfHwgaXNIZWxwZXIobm9kZS5jYWxsZWUpO1xuICB9XG5cbiAgcmV0dXJuIHN0YXRlO1xufVxuXG5mdW5jdGlvbiBpc0hlbHBlcihub2RlKSB7XG4gIGlmICh0KCkuaXNNZW1iZXJFeHByZXNzaW9uKG5vZGUpKSB7XG4gICAgcmV0dXJuIGlzSGVscGVyKG5vZGUub2JqZWN0KSB8fCBpc0hlbHBlcihub2RlLnByb3BlcnR5KTtcbiAgfSBlbHNlIGlmICh0KCkuaXNJZGVudGlmaWVyKG5vZGUpKSB7XG4gICAgcmV0dXJuIG5vZGUubmFtZSA9PT0gXCJyZXF1aXJlXCIgfHwgbm9kZS5uYW1lWzBdID09PSBcIl9cIjtcbiAgfSBlbHNlIGlmICh0KCkuaXNDYWxsRXhwcmVzc2lvbihub2RlKSkge1xuICAgIHJldHVybiBpc0hlbHBlcihub2RlLmNhbGxlZSk7XG4gIH0gZWxzZSBpZiAodCgpLmlzQmluYXJ5KG5vZGUpIHx8IHQoKS5pc0Fzc2lnbm1lbnRFeHByZXNzaW9uKG5vZGUpKSB7XG4gICAgcmV0dXJuIHQoKS5pc0lkZW50aWZpZXIobm9kZS5sZWZ0KSAmJiBpc0hlbHBlcihub2RlLmxlZnQpIHx8IGlzSGVscGVyKG5vZGUucmlnaHQpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpc1R5cGUobm9kZSkge1xuICByZXR1cm4gdCgpLmlzTGl0ZXJhbChub2RlKSB8fCB0KCkuaXNPYmplY3RFeHByZXNzaW9uKG5vZGUpIHx8IHQoKS5pc0FycmF5RXhwcmVzc2lvbihub2RlKSB8fCB0KCkuaXNJZGVudGlmaWVyKG5vZGUpIHx8IHQoKS5pc01lbWJlckV4cHJlc3Npb24obm9kZSk7XG59XG5cbmNvbnN0IG5vZGVzID0ge1xuICBBc3NpZ25tZW50RXhwcmVzc2lvbihub2RlKSB7XG4gICAgY29uc3Qgc3RhdGUgPSBjcmF3bChub2RlLnJpZ2h0KTtcblxuICAgIGlmIChzdGF0ZS5oYXNDYWxsICYmIHN0YXRlLmhhc0hlbHBlciB8fCBzdGF0ZS5oYXNGdW5jdGlvbikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYmVmb3JlOiBzdGF0ZS5oYXNGdW5jdGlvbixcbiAgICAgICAgYWZ0ZXI6IHRydWVcbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gIFN3aXRjaENhc2Uobm9kZSwgcGFyZW50KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGJlZm9yZTogbm9kZS5jb25zZXF1ZW50Lmxlbmd0aCB8fCBwYXJlbnQuY2FzZXNbMF0gPT09IG5vZGUsXG4gICAgICBhZnRlcjogIW5vZGUuY29uc2VxdWVudC5sZW5ndGggJiYgcGFyZW50LmNhc2VzW3BhcmVudC5jYXNlcy5sZW5ndGggLSAxXSA9PT0gbm9kZVxuICAgIH07XG4gIH0sXG5cbiAgTG9naWNhbEV4cHJlc3Npb24obm9kZSkge1xuICAgIGlmICh0KCkuaXNGdW5jdGlvbihub2RlLmxlZnQpIHx8IHQoKS5pc0Z1bmN0aW9uKG5vZGUucmlnaHQpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhZnRlcjogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgTGl0ZXJhbChub2RlKSB7XG4gICAgaWYgKG5vZGUudmFsdWUgPT09IFwidXNlIHN0cmljdFwiKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhZnRlcjogdHJ1ZVxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgQ2FsbEV4cHJlc3Npb24obm9kZSkge1xuICAgIGlmICh0KCkuaXNGdW5jdGlvbihub2RlLmNhbGxlZSkgfHwgaXNIZWxwZXIobm9kZSkpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGJlZm9yZTogdHJ1ZSxcbiAgICAgICAgYWZ0ZXI6IHRydWVcbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gIFZhcmlhYmxlRGVjbGFyYXRpb24obm9kZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZS5kZWNsYXJhdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGRlY2xhciA9IG5vZGUuZGVjbGFyYXRpb25zW2ldO1xuICAgICAgbGV0IGVuYWJsZWQgPSBpc0hlbHBlcihkZWNsYXIuaWQpICYmICFpc1R5cGUoZGVjbGFyLmluaXQpO1xuXG4gICAgICBpZiAoIWVuYWJsZWQpIHtcbiAgICAgICAgY29uc3Qgc3RhdGUgPSBjcmF3bChkZWNsYXIuaW5pdCk7XG4gICAgICAgIGVuYWJsZWQgPSBpc0hlbHBlcihkZWNsYXIuaW5pdCkgJiYgc3RhdGUuaGFzQ2FsbCB8fCBzdGF0ZS5oYXNGdW5jdGlvbjtcbiAgICAgIH1cblxuICAgICAgaWYgKGVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBiZWZvcmU6IHRydWUsXG4gICAgICAgICAgYWZ0ZXI6IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgSWZTdGF0ZW1lbnQobm9kZSkge1xuICAgIGlmICh0KCkuaXNCbG9ja1N0YXRlbWVudChub2RlLmNvbnNlcXVlbnQpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBiZWZvcmU6IHRydWUsXG4gICAgICAgIGFmdGVyOiB0cnVlXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG59O1xuZXhwb3J0cy5ub2RlcyA9IG5vZGVzO1xuXG5ub2Rlcy5PYmplY3RQcm9wZXJ0eSA9IG5vZGVzLk9iamVjdFR5cGVQcm9wZXJ0eSA9IG5vZGVzLk9iamVjdE1ldGhvZCA9IGZ1bmN0aW9uIChub2RlLCBwYXJlbnQpIHtcbiAgaWYgKHBhcmVudC5wcm9wZXJ0aWVzWzBdID09PSBub2RlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGJlZm9yZTogdHJ1ZVxuICAgIH07XG4gIH1cbn07XG5cbm5vZGVzLk9iamVjdFR5cGVDYWxsUHJvcGVydHkgPSBmdW5jdGlvbiAobm9kZSwgcGFyZW50KSB7XG4gIGlmIChwYXJlbnQuY2FsbFByb3BlcnRpZXNbMF0gPT09IG5vZGUgJiYgKCFwYXJlbnQucHJvcGVydGllcyB8fCAhcGFyZW50LnByb3BlcnRpZXMubGVuZ3RoKSkge1xuICAgIHJldHVybiB7XG4gICAgICBiZWZvcmU6IHRydWVcbiAgICB9O1xuICB9XG59O1xuXG5ub2Rlcy5PYmplY3RUeXBlSW5kZXhlciA9IGZ1bmN0aW9uIChub2RlLCBwYXJlbnQpIHtcbiAgaWYgKHBhcmVudC5pbmRleGVyc1swXSA9PT0gbm9kZSAmJiAoIXBhcmVudC5wcm9wZXJ0aWVzIHx8ICFwYXJlbnQucHJvcGVydGllcy5sZW5ndGgpICYmICghcGFyZW50LmNhbGxQcm9wZXJ0aWVzIHx8ICFwYXJlbnQuY2FsbFByb3BlcnRpZXMubGVuZ3RoKSkge1xuICAgIHJldHVybiB7XG4gICAgICBiZWZvcmU6IHRydWVcbiAgICB9O1xuICB9XG59O1xuXG5ub2Rlcy5PYmplY3RUeXBlSW50ZXJuYWxTbG90ID0gZnVuY3Rpb24gKG5vZGUsIHBhcmVudCkge1xuICBpZiAocGFyZW50LmludGVybmFsU2xvdHNbMF0gPT09IG5vZGUgJiYgKCFwYXJlbnQucHJvcGVydGllcyB8fCAhcGFyZW50LnByb3BlcnRpZXMubGVuZ3RoKSAmJiAoIXBhcmVudC5jYWxsUHJvcGVydGllcyB8fCAhcGFyZW50LmNhbGxQcm9wZXJ0aWVzLmxlbmd0aCkgJiYgKCFwYXJlbnQuaW5kZXhlcnMgfHwgIXBhcmVudC5pbmRleGVycy5sZW5ndGgpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGJlZm9yZTogdHJ1ZVxuICAgIH07XG4gIH1cbn07XG5cbmNvbnN0IGxpc3QgPSB7XG4gIFZhcmlhYmxlRGVjbGFyYXRpb24obm9kZSkge1xuICAgIHJldHVybiBub2RlLmRlY2xhcmF0aW9ucy5tYXAoZGVjbCA9PiBkZWNsLmluaXQpO1xuICB9LFxuXG4gIEFycmF5RXhwcmVzc2lvbihub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUuZWxlbWVudHM7XG4gIH0sXG5cbiAgT2JqZWN0RXhwcmVzc2lvbihub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUucHJvcGVydGllcztcbiAgfVxuXG59O1xuZXhwb3J0cy5saXN0ID0gbGlzdDtcbltbXCJGdW5jdGlvblwiLCB0cnVlXSwgW1wiQ2xhc3NcIiwgdHJ1ZV0sIFtcIkxvb3BcIiwgdHJ1ZV0sIFtcIkxhYmVsZWRTdGF0ZW1lbnRcIiwgdHJ1ZV0sIFtcIlN3aXRjaFN0YXRlbWVudFwiLCB0cnVlXSwgW1wiVHJ5U3RhdGVtZW50XCIsIHRydWVdXS5mb3JFYWNoKGZ1bmN0aW9uIChbdHlwZSwgYW1vdW50c10pIHtcbiAgaWYgKHR5cGVvZiBhbW91bnRzID09PSBcImJvb2xlYW5cIikge1xuICAgIGFtb3VudHMgPSB7XG4gICAgICBhZnRlcjogYW1vdW50cyxcbiAgICAgIGJlZm9yZTogYW1vdW50c1xuICAgIH07XG4gIH1cblxuICBbdHlwZV0uY29uY2F0KHQoKS5GTElQUEVEX0FMSUFTX0tFWVNbdHlwZV0gfHwgW10pLmZvckVhY2goZnVuY3Rpb24gKHR5cGUpIHtcbiAgICBub2Rlc1t0eXBlXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBhbW91bnRzO1xuICAgIH07XG4gIH0pO1xufSk7Il19