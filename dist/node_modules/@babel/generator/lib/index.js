"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = _default;
exports.CodeGenerator = void 0;

var _sourceMap = _interopRequireDefault(require("./source-map"));

var _printer = _interopRequireDefault(require("./printer"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

class Generator extends _printer.default {
  constructor(ast, opts = {}, code) {
    const format = normalizeOptions(code, opts);
    const map = opts.sourceMaps ? new _sourceMap.default(opts, code) : null;
    super(format, map);
    this.ast = ast;
  }

  generate() {
    return super.generate(this.ast);
  }

}

function normalizeOptions(code, opts) {
  const format = {
    auxiliaryCommentBefore: opts.auxiliaryCommentBefore,
    auxiliaryCommentAfter: opts.auxiliaryCommentAfter,
    shouldPrintComment: opts.shouldPrintComment,
    retainLines: opts.retainLines,
    retainFunctionParens: opts.retainFunctionParens,
    comments: opts.comments == null || opts.comments,
    compact: opts.compact,
    minified: opts.minified,
    concise: opts.concise,
    jsonCompatibleStrings: opts.jsonCompatibleStrings,
    indent: {
      adjustMultilineComment: true,
      style: "  ",
      base: 0
    },
    decoratorsBeforeExport: !!opts.decoratorsBeforeExport,
    jsescOption: Object.assign({
      quotes: "double",
      wrap: true
    }, opts.jsescOption)
  };

  if (format.minified) {
    format.compact = true;

    format.shouldPrintComment = format.shouldPrintComment || (() => format.comments);
  } else {
    format.shouldPrintComment = format.shouldPrintComment || (value => format.comments || value.indexOf("@license") >= 0 || value.indexOf("@preserve") >= 0);
  }

  if (format.compact === "auto") {
    format.compact = code.length > 500000;

    if (format.compact) {
      console.error("[BABEL] Note: The code generator has deoptimised the styling of " + `${opts.filename} as it exceeds the max of ${"500KB"}.`);
    }
  }

  if (format.compact) {
    format.indent.adjustMultilineComment = false;
  }

  return format;
}

class CodeGenerator {
  constructor(ast, opts, code) {
    this._generator = new Generator(ast, opts, code);
  }

  generate() {
    return this._generator.generate();
  }

}

exports.CodeGenerator = CodeGenerator;

function _default(ast, opts, code) {
  const gen = new Generator(ast, opts, code);
  return gen.generate();
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9AYmFiZWwvZ2VuZXJhdG9yL2xpYi9pbmRleC5qcyJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsIkNvZGVHZW5lcmF0b3IiLCJfc291cmNlTWFwIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfcHJpbnRlciIsIm9iaiIsIl9fZXNNb2R1bGUiLCJHZW5lcmF0b3IiLCJjb25zdHJ1Y3RvciIsImFzdCIsIm9wdHMiLCJjb2RlIiwiZm9ybWF0Iiwibm9ybWFsaXplT3B0aW9ucyIsIm1hcCIsInNvdXJjZU1hcHMiLCJnZW5lcmF0ZSIsImF1eGlsaWFyeUNvbW1lbnRCZWZvcmUiLCJhdXhpbGlhcnlDb21tZW50QWZ0ZXIiLCJzaG91bGRQcmludENvbW1lbnQiLCJyZXRhaW5MaW5lcyIsInJldGFpbkZ1bmN0aW9uUGFyZW5zIiwiY29tbWVudHMiLCJjb21wYWN0IiwibWluaWZpZWQiLCJjb25jaXNlIiwianNvbkNvbXBhdGlibGVTdHJpbmdzIiwiaW5kZW50IiwiYWRqdXN0TXVsdGlsaW5lQ29tbWVudCIsInN0eWxlIiwiYmFzZSIsImRlY29yYXRvcnNCZWZvcmVFeHBvcnQiLCJqc2VzY09wdGlvbiIsImFzc2lnbiIsInF1b3RlcyIsIndyYXAiLCJpbmRleE9mIiwibGVuZ3RoIiwiY29uc29sZSIsImVycm9yIiwiZmlsZW5hbWUiLCJfZ2VuZXJhdG9yIiwiZ2VuIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQUEsTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztBQUMzQ0MsRUFBQUEsS0FBSyxFQUFFO0FBRG9DLENBQTdDO0FBR0FELE9BQU8sQ0FBQ0UsT0FBUixHQUFrQkMsUUFBbEI7QUFDQUgsT0FBTyxDQUFDSSxhQUFSLEdBQXdCLEtBQUssQ0FBN0I7O0FBRUEsSUFB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bnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbmV4cG9ydHMuQ29kZUdlbmVyYXRvciA9IHZvaWQgMDtcblxudmFyIF9zb3VyY2VNYXAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3NvdXJjZS1tYXBcIikpO1xuXG52YXIgX3ByaW50ZXIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3ByaW50ZXJcIikpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5jbGFzcyBHZW5lcmF0b3IgZXh0ZW5kcyBfcHJpbnRlci5kZWZhdWx0IHtcbiAgY29uc3RydWN0b3IoYXN0LCBvcHRzID0ge30sIGNvZGUpIHtcbiAgICBjb25zdCBmb3JtYXQgPSBub3JtYWxpemVPcHRpb25zKGNvZGUsIG9wdHMpO1xuICAgIGNvbnN0IG1hcCA9IG9wdHMuc291cmNlTWFwcyA/IG5ldyBfc291cmNlTWFwLmRlZmF1bHQob3B0cywgY29kZSkgOiBudWxsO1xuICAgIHN1cGVyKGZvcm1hdCwgbWFwKTtcbiAgICB0aGlzLmFzdCA9IGFzdDtcbiAgfVxuXG4gIGdlbmVyYXRlKCkge1xuICAgIHJldHVybiBzdXBlci5nZW5lcmF0ZSh0aGlzLmFzdCk7XG4gIH1cblxufVxuXG5mdW5jdGlvbiBub3JtYWxpemVPcHRpb25zKGNvZGUsIG9wdHMpIHtcbiAgY29uc3QgZm9ybWF0ID0ge1xuICAgIGF1eGlsaWFyeUNvbW1lbnRCZWZvcmU6IG9wdHMuYXV4aWxpYXJ5Q29tbWVudEJlZm9yZSxcbiAgICBhdXhpbGlhcnlDb21tZW50QWZ0ZXI6IG9wdHMuYXV4aWxpYXJ5Q29tbWVudEFmdGVyLFxuICAgIHNob3VsZFByaW50Q29tbWVudDogb3B0cy5zaG91bGRQcmludENvbW1lbnQsXG4gICAgcmV0YWluTGluZXM6IG9wdHMucmV0YWluTGluZXMsXG4gICAgcmV0YWluRnVuY3Rpb25QYXJlbnM6IG9wdHMucmV0YWluRnVuY3Rpb25QYXJlbnMsXG4gICAgY29tbWVudHM6IG9wdHMuY29tbWVudHMgPT0gbnVsbCB8fCBvcHRzLmNvbW1lbnRzLFxuICAgIGNvbXBhY3Q6IG9wdHMuY29tcGFjdCxcbiAgICBtaW5pZmllZDogb3B0cy5taW5pZmllZCxcbiAgICBjb25jaXNlOiBvcHRzLmNvbmNpc2UsXG4gICAganNvbkNvbXBhdGlibGVTdHJpbmdzOiBvcHRzLmpzb25Db21wYXRpYmxlU3RyaW5ncyxcbiAgICBpbmRlbnQ6IHtcbiAgICAgIGFkanVzdE11bHRpbGluZUNvbW1lbnQ6IHRydWUsXG4gICAgICBzdHlsZTogXCIgIFwiLFxuICAgICAgYmFzZTogMFxuICAgIH0sXG4gICAgZGVjb3JhdG9yc0JlZm9yZUV4cG9ydDogISFvcHRzLmRlY29yYXRvcnNCZWZvcmVFeHBvcnQsXG4gICAganNlc2NPcHRpb246IE9iamVjdC5hc3NpZ24oe1xuICAgICAgcXVvdGVzOiBcImRvdWJsZVwiLFxuICAgICAgd3JhcDogdHJ1ZVxuICAgIH0sIG9wdHMuanNlc2NPcHRpb24pXG4gIH07XG5cbiAgaWYgKGZvcm1hdC5taW5pZmllZCkge1xuICAgIGZvcm1hdC5jb21wYWN0ID0gdHJ1ZTtcblxuICAgIGZvcm1hdC5zaG91bGRQcmludENvbW1lbnQgPSBmb3JtYXQuc2hvdWxkUHJpbnRDb21tZW50IHx8ICgoKSA9PiBmb3JtYXQuY29tbWVudHMpO1xuICB9IGVsc2Uge1xuICAgIGZvcm1hdC5zaG91bGRQcmludENvbW1lbnQgPSBmb3JtYXQuc2hvdWxkUHJpbnRDb21tZW50IHx8ICh2YWx1ZSA9PiBmb3JtYXQuY29tbWVudHMgfHwgdmFsdWUuaW5kZXhPZihcIkBsaWNlbnNlXCIpID49IDAgfHwgdmFsdWUuaW5kZXhPZihcIkBwcmVzZXJ2ZVwiKSA+PSAwKTtcbiAgfVxuXG4gIGlmIChmb3JtYXQuY29tcGFjdCA9PT0gXCJhdXRvXCIpIHtcbiAgICBmb3JtYXQuY29tcGFjdCA9IGNvZGUubGVuZ3RoID4gNTAwMDAwO1xuXG4gICAgaWYgKGZvcm1hdC5jb21wYWN0KSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiW0JBQkVMXSBOb3RlOiBUaGUgY29kZSBnZW5lcmF0b3IgaGFzIGRlb3B0aW1pc2VkIHRoZSBzdHlsaW5nIG9mIFwiICsgYCR7b3B0cy5maWxlbmFtZX0gYXMgaXQgZXhjZWVkcyB0aGUgbWF4IG9mICR7XCI1MDBLQlwifS5gKTtcbiAgICB9XG4gIH1cblxuICBpZiAoZm9ybWF0LmNvbXBhY3QpIHtcbiAgICBmb3JtYXQuaW5kZW50LmFkanVzdE11bHRpbGluZUNvbW1lbnQgPSBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiBmb3JtYXQ7XG59XG5cbmNsYXNzIENvZGVHZW5lcmF0b3Ige1xuICBjb25zdHJ1Y3Rvcihhc3QsIG9wdHMsIGNvZGUpIHtcbiAgICB0aGlzLl9nZW5lcmF0b3IgPSBuZXcgR2VuZXJhdG9yKGFzdCwgb3B0cywgY29kZSk7XG4gIH1cblxuICBnZW5lcmF0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fZ2VuZXJhdG9yLmdlbmVyYXRlKCk7XG4gIH1cblxufVxuXG5leHBvcnRzLkNvZGVHZW5lcmF0b3IgPSBDb2RlR2VuZXJhdG9yO1xuXG5mdW5jdGlvbiBfZGVmYXVsdChhc3QsIG9wdHMsIGNvZGUpIHtcbiAgY29uc3QgZ2VuID0gbmV3IEdlbmVyYXRvcihhc3QsIG9wdHMsIGNvZGUpO1xuICByZXR1cm4gZ2VuLmdlbmVyYXRlKCk7XG59Il19