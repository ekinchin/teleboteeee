"use strict";
/**
 * Module dependencies.
 */

var tty = require('tty');

var util = require('util');
/**
 * This is the Node.js implementation of `debug()`.
 */


exports.init = init;
exports.log = log;
exports.formatArgs = formatArgs;
exports.save = save;
exports.load = load;
exports.useColors = useColors;
/**
 * Colors.
 */

exports.colors = [6, 2, 3, 4, 5, 1];

try {
  // Optional dependency (as in, doesn't need to be installed, NOT like optionalDependencies in package.json)
  // eslint-disable-next-line import/no-extraneous-dependencies
  var supportsColor = require('supports-color');

  if (supportsColor && (supportsColor.stderr || supportsColor).level >= 2) {
    exports.colors = [20, 21, 26, 27, 32, 33, 38, 39, 40, 41, 42, 43, 44, 45, 56, 57, 62, 63, 68, 69, 74, 75, 76, 77, 78, 79, 80, 81, 92, 93, 98, 99, 112, 113, 128, 129, 134, 135, 148, 149, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 178, 179, 184, 185, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 214, 215, 220, 221];
  }
} catch (error) {} // Swallow - we only care if `supports-color` is available; it doesn't have to be.

/**
 * Build up the default `inspectOpts` object from the environment variables.
 *
 *   $ DEBUG_COLORS=no DEBUG_DEPTH=10 DEBUG_SHOW_HIDDEN=enabled node script.js
 */


exports.inspectOpts = Object.keys(process.env).filter(function (key) {
  return /^debug_/i.test(key);
}).reduce(function (obj, key) {
  // Camel-case
  var prop = key.substring(6).toLowerCase().replace(/_([a-z])/g, function (_, k) {
    return k.toUpperCase();
  }); // Coerce string value into JS value

  var val = process.env[key];

  if (/^(yes|on|true|enabled)$/i.test(val)) {
    val = true;
  } else if (/^(no|off|false|disabled)$/i.test(val)) {
    val = false;
  } else if (val === 'null') {
    val = null;
  } else {
    val = Number(val);
  }

  obj[prop] = val;
  return obj;
}, {});
/**
 * Is stdout a TTY? Colored output is enabled when `true`.
 */

function useColors() {
  return 'colors' in exports.inspectOpts ? Boolean(exports.inspectOpts.colors) : tty.isatty(process.stderr.fd);
}
/**
 * Adds ANSI color escape codes if enabled.
 *
 * @api public
 */


function formatArgs(args) {
  var name = this.namespace,
      useColors = this.useColors;

  if (useColors) {
    var c = this.color;
    var colorCode = "\x1B[3" + (c < 8 ? c : '8;5;' + c);
    var prefix = "  ".concat(colorCode, ";1m").concat(name, " \x1B[0m");
    args[0] = prefix + args[0].split('\n').join('\n' + prefix);
    args.push(colorCode + 'm+' + module.exports.humanize(this.diff) + "\x1B[0m");
  } else {
    args[0] = getDate() + name + ' ' + args[0];
  }
}

function getDate() {
  if (exports.inspectOpts.hideDate) {
    return '';
  }

  return new Date().toISOString() + ' ';
}
/**
 * Invokes `util.format()` with the specified arguments and writes to stderr.
 */


function log() {
  return process.stderr.write(util.format.apply(util, arguments) + '\n');
}
/**
 * Save `namespaces`.
 *
 * @param {String} namespaces
 * @api private
 */


function save(namespaces) {
  if (namespaces) {
    process.env.DEBUG = namespaces;
  } else {
    // If you set a process.env field to null or undefined, it gets cast to the
    // string 'null' or 'undefined'. Just delete instead.
    delete process.env.DEBUG;
  }
}
/**
 * Load `namespaces`.
 *
 * @return {String} returns the previously persisted debug modes
 * @api private
 */


function load() {
  return process.env.DEBUG;
}
/**
 * Init logic for `debug` instances.
 *
 * Create a new `inspectOpts` object in case `useColors` is set
 * differently for a particular `debug` instance.
 */


function init(debug) {
  debug.inspectOpts = {};
  var keys = Object.keys(exports.inspectOpts);

  for (var i = 0; i < keys.length; i++) {
    debug.inspectOpts[keys[i]] = exports.inspectOpts[keys[i]];
  }
}

module.exports = require('./common')(exports);
var formatters = module.exports.formatters;
/**
 * Map %o to `util.inspect()`, all on a single line.
 */

formatters.o = function (v) {
  this.inspectOpts.colors = this.useColors;
  return util.inspect(v, this.inspectOpts).replace(/\s*\n\s*/g, ' ');
};
/**
 * Map %O to `util.inspect()`, allowing multiple lines if needed.
 */


formatters.O = function (v) {
  this.inspectOpts.colors = this.useColors;
  return util.inspect(v, this.inspectOpts);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9AYmFiZWwvY29yZS9ub2RlX21vZHVsZXMvZGVidWcvc3JjL25vZGUuanMiXSwibmFtZXMiOlsidHR5IiwicmVxdWlyZSIsInV0aWwiLCJleHBvcnRzIiwiaW5pdCIsImxvZyIsImZvcm1hdEFyZ3MiLCJzYXZlIiwibG9hZCIsInVzZUNvbG9ycyIsImNvbG9ycyIsInN1cHBvcnRzQ29sb3IiLCJzdGRlcnIiLCJsZXZlbCIsImVycm9yIiwiaW5zcGVjdE9wdHMiLCJPYmplY3QiLCJrZXlzIiwicHJvY2VzcyIsImVudiIsImZpbHRlciIsImtleSIsInRlc3QiLCJyZWR1Y2UiLCJvYmoiLCJwcm9wIiwic3Vic3RyaW5nIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwiXyIsImsiLCJ0b1VwcGVyQ2FzZSIsInZhbCIsIk51bWJlciIsIkJvb2xlYW4iLCJpc2F0dHkiLCJmZCIsImFyZ3MiLCJuYW1lIiwibmFtZXNwYWNlIiwiYyIsImNvbG9yIiwiY29sb3JDb2RlIiwicHJlZml4IiwiY29uY2F0Iiwic3BsaXQiLCJqb2luIiwicHVzaCIsIm1vZHVsZSIsImh1bWFuaXplIiwiZGlmZiIsImdldERhdGUiLCJoaWRlRGF0ZSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIndyaXRlIiwiZm9ybWF0IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJuYW1lc3BhY2VzIiwiREVCVUciLCJkZWJ1ZyIsImkiLCJsZW5ndGgiLCJmb3JtYXR0ZXJzIiwibyIsInYiLCJpbnNwZWN0IiwiTyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFFQTs7OztBQUdBLElBQUlBLEdBQUcsR0FBR0MsT0FBTyxDQUFDLEtBQUQsQ0FBakI7O0FBRUEsSUFBSUMsSUFBSSxHQUFHRCxPQUFPLENBQUMsTUFBRCxDQUFsQjtBQUNBOzs7OztBQUtBRSxPQUFPLENBQUNDLElBQVIsR0FBZUEsSUFBZjtBQUNBRCxPQUFPLENBQUNFLEdBQVIsR0FBY0EsR0FBZDtBQUNB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QUFqQixHQUEwQixLQUFLRCxTQUEvQjtBQUNBLFNBQU9QLElBQUksQ0FBQ2lFLE9BQUwsQ0FBYUQsQ0FBYixFQUFnQixLQUFLbkQsV0FBckIsQ0FBUDtBQUNELENBSEQiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuICovXG52YXIgdHR5ID0gcmVxdWlyZSgndHR5Jyk7XG5cbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbCcpO1xuLyoqXG4gKiBUaGlzIGlzIHRoZSBOb2RlLmpzIGltcGxlbWVudGF0aW9uIG9mIGBkZWJ1ZygpYC5cbiAqL1xuXG5cbmV4cG9ydHMuaW5pdCA9IGluaXQ7XG5leHBvcnRzLmxvZyA9IGxvZztcbmV4cG9ydHMuZm9ybWF0QXJncyA9IGZvcm1hdEFyZ3M7XG5leHBvcnRzLnNhdmUgPSBzYXZlO1xuZXhwb3J0cy5sb2FkID0gbG9hZDtcbmV4cG9ydHMudXNlQ29sb3JzID0gdXNlQ29sb3JzO1xuLyoqXG4gKiBDb2xvcnMuXG4gKi9cblxuZXhwb3J0cy5jb2xvcnMgPSBbNiwgMiwgMywgNCwgNSwgMV07XG5cbnRyeSB7XG4gIC8vIE9wdGlvbmFsIGRlcGVuZGVuY3kgKGFzIGluLCBkb2Vzbid0IG5lZWQgdG8gYmUgaW5zdGFsbGVkLCBOT1QgbGlrZSBvcHRpb25hbERlcGVuZGVuY2llcyBpbiBwYWNrYWdlLmpzb24pXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tZXh0cmFuZW91cy1kZXBlbmRlbmNpZXNcbiAgdmFyIHN1cHBvcnRzQ29sb3IgPSByZXF1aXJlKCdzdXBwb3J0cy1jb2xvcicpO1xuXG4gIGlmIChzdXBwb3J0c0NvbG9yICYmIChzdXBwb3J0c0NvbG9yLnN0ZGVyciB8fCBzdXBwb3J0c0NvbG9yKS5sZXZlbCA+PSAyKSB7XG4gICAgZXhwb3J0cy5jb2xvcnMgPSBbMjAsIDIxLCAyNiwgMjcsIDMyLCAzMywgMzgsIDM5LCA0MCwgNDEsIDQyLCA0MywgNDQsIDQ1LCA1NiwgNTcsIDYyLCA2MywgNjgsIDY5LCA3NCwgNzUsIDc2LCA3NywgNzgsIDc5LCA4MCwgODEsIDkyLCA5MywgOTgsIDk5LCAxMTIsIDExMywgMTI4LCAxMjksIDEzNCwgMTM1LCAxNDgsIDE0OSwgMTYwLCAxNjEsIDE2MiwgMTYzLCAxNjQsIDE2NSwgMTY2LCAxNjcsIDE2OCwgMTY5LCAxNzAsIDE3MSwgMTcyLCAxNzMsIDE3OCwgMTc5LCAxODQsIDE4NSwgMTk2LCAxOTcsIDE5OCwgMTk5LCAyMDAsIDIwMSwgMjAyLCAyMDMsIDIwNCwgMjA1LCAyMDYsIDIwNywgMjA4LCAyMDksIDIxNCwgMjE1LCAyMjAsIDIyMV07XG4gIH1cbn0gY2F0Y2ggKGVycm9yKSB7fSAvLyBTd2FsbG93IC0gd2Ugb25seSBjYXJlIGlmIGBzdXBwb3J0cy1jb2xvcmAgaXMgYXZhaWxhYmxlOyBpdCBkb2Vzbid0IGhhdmUgdG8gYmUuXG5cbi8qKlxuICogQnVpbGQgdXAgdGhlIGRlZmF1bHQgYGluc3BlY3RPcHRzYCBvYmplY3QgZnJvbSB0aGUgZW52aXJvbm1lbnQgdmFyaWFibGVzLlxuICpcbiAqICAgJCBERUJVR19DT0xPUlM9bm8gREVCVUdfREVQVEg9MTAgREVCVUdfU0hPV19ISURERU49ZW5hYmxlZCBub2RlIHNjcmlwdC5qc1xuICovXG5cblxuZXhwb3J0cy5pbnNwZWN0T3B0cyA9IE9iamVjdC5rZXlzKHByb2Nlc3MuZW52KS5maWx0ZXIoZnVuY3Rpb24gKGtleSkge1xuICByZXR1cm4gL15kZWJ1Z18vaS50ZXN0KGtleSk7XG59KS5yZWR1Y2UoZnVuY3Rpb24gKG9iaiwga2V5KSB7XG4gIC8vIENhbWVsLWNhc2VcbiAgdmFyIHByb3AgPSBrZXkuc3Vic3RyaW5nKDYpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXyhbYS16XSkvZywgZnVuY3Rpb24gKF8sIGspIHtcbiAgICByZXR1cm4gay50b1VwcGVyQ2FzZSgpO1xuICB9KTsgLy8gQ29lcmNlIHN0cmluZyB2YWx1ZSBpbnRvIEpTIHZhbHVlXG5cbiAgdmFyIHZhbCA9IHByb2Nlc3MuZW52W2tleV07XG5cbiAgaWYgKC9eKHllc3xvbnx0cnVlfGVuYWJsZWQpJC9pLnRlc3QodmFsKSkge1xuICAgIHZhbCA9IHRydWU7XG4gIH0gZWxzZSBpZiAoL14obm98b2ZmfGZhbHNlfGRpc2FibGVkKSQvaS50ZXN0KHZhbCkpIHtcbiAgICB2YWwgPSBmYWxzZTtcbiAgfSBlbHNlIGlmICh2YWwgPT09ICdudWxsJykge1xuICAgIHZhbCA9IG51bGw7XG4gIH0gZWxzZSB7XG4gICAgdmFsID0gTnVtYmVyKHZhbCk7XG4gIH1cblxuICBvYmpbcHJvcF0gPSB2YWw7XG4gIHJldHVybiBvYmo7XG59LCB7fSk7XG4vKipcbiAqIElzIHN0ZG91dCBhIFRUWT8gQ29sb3JlZCBvdXRwdXQgaXMgZW5hYmxlZCB3aGVuIGB0cnVlYC5cbiAqL1xuXG5mdW5jdGlvbiB1c2VDb2xvcnMoKSB7XG4gIHJldHVybiAnY29sb3JzJyBpbiBleHBvcnRzLmluc3BlY3RPcHRzID8gQm9vbGVhbihleHBvcnRzLmluc3BlY3RPcHRzLmNvbG9ycykgOiB0dHkuaXNhdHR5KHByb2Nlc3Muc3RkZXJyLmZkKTtcbn1cbi8qKlxuICogQWRkcyBBTlNJIGNvbG9yIGVzY2FwZSBjb2RlcyBpZiBlbmFibGVkLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuXG5mdW5jdGlvbiBmb3JtYXRBcmdzKGFyZ3MpIHtcbiAgdmFyIG5hbWUgPSB0aGlzLm5hbWVzcGFjZSxcbiAgICAgIHVzZUNvbG9ycyA9IHRoaXMudXNlQ29sb3JzO1xuXG4gIGlmICh1c2VDb2xvcnMpIHtcbiAgICB2YXIgYyA9IHRoaXMuY29sb3I7XG4gICAgdmFyIGNvbG9yQ29kZSA9IFwiXFx4MUJbM1wiICsgKGMgPCA4ID8gYyA6ICc4OzU7JyArIGMpO1xuICAgIHZhciBwcmVmaXggPSBcIiAgXCIuY29uY2F0KGNvbG9yQ29kZSwgXCI7MW1cIikuY29uY2F0KG5hbWUsIFwiIFxceDFCWzBtXCIpO1xuICAgIGFyZ3NbMF0gPSBwcmVmaXggKyBhcmdzWzBdLnNwbGl0KCdcXG4nKS5qb2luKCdcXG4nICsgcHJlZml4KTtcbiAgICBhcmdzLnB1c2goY29sb3JDb2RlICsgJ20rJyArIG1vZHVsZS5leHBvcnRzLmh1bWFuaXplKHRoaXMuZGlmZikgKyBcIlxceDFCWzBtXCIpO1xuICB9IGVsc2Uge1xuICAgIGFyZ3NbMF0gPSBnZXREYXRlKCkgKyBuYW1lICsgJyAnICsgYXJnc1swXTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXREYXRlKCkge1xuICBpZiAoZXhwb3J0cy5pbnNwZWN0T3B0cy5oaWRlRGF0ZSkge1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIHJldHVybiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgKyAnICc7XG59XG4vKipcbiAqIEludm9rZXMgYHV0aWwuZm9ybWF0KClgIHdpdGggdGhlIHNwZWNpZmllZCBhcmd1bWVudHMgYW5kIHdyaXRlcyB0byBzdGRlcnIuXG4gKi9cblxuXG5mdW5jdGlvbiBsb2coKSB7XG4gIHJldHVybiBwcm9jZXNzLnN0ZGVyci53cml0ZSh1dGlsLmZvcm1hdC5hcHBseSh1dGlsLCBhcmd1bWVudHMpICsgJ1xcbicpO1xufVxuLyoqXG4gKiBTYXZlIGBuYW1lc3BhY2VzYC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlc1xuICogQGFwaSBwcml2YXRlXG4gKi9cblxuXG5mdW5jdGlvbiBzYXZlKG5hbWVzcGFjZXMpIHtcbiAgaWYgKG5hbWVzcGFjZXMpIHtcbiAgICBwcm9jZXNzLmVudi5ERUJVRyA9IG5hbWVzcGFjZXM7XG4gIH0gZWxzZSB7XG4gICAgLy8gSWYgeW91IHNldCBhIHByb2Nlc3MuZW52IGZpZWxkIHRvIG51bGwgb3IgdW5kZWZpbmVkLCBpdCBnZXRzIGNhc3QgdG8gdGhlXG4gICAgLy8gc3RyaW5nICdudWxsJyBvciAndW5kZWZpbmVkJy4gSnVzdCBkZWxldGUgaW5zdGVhZC5cbiAgICBkZWxldGUgcHJvY2Vzcy5lbnYuREVCVUc7XG4gIH1cbn1cbi8qKlxuICogTG9hZCBgbmFtZXNwYWNlc2AuXG4gKlxuICogQHJldHVybiB7U3RyaW5nfSByZXR1cm5zIHRoZSBwcmV2aW91c2x5IHBlcnNpc3RlZCBkZWJ1ZyBtb2Rlc1xuICogQGFwaSBwcml2YXRlXG4gKi9cblxuXG5mdW5jdGlvbiBsb2FkKCkge1xuICByZXR1cm4gcHJvY2Vzcy5lbnYuREVCVUc7XG59XG4vKipcbiAqIEluaXQgbG9naWMgZm9yIGBkZWJ1Z2AgaW5zdGFuY2VzLlxuICpcbiAqIENyZWF0ZSBhIG5ldyBgaW5zcGVjdE9wdHNgIG9iamVjdCBpbiBjYXNlIGB1c2VDb2xvcnNgIGlzIHNldFxuICogZGlmZmVyZW50bHkgZm9yIGEgcGFydGljdWxhciBgZGVidWdgIGluc3RhbmNlLlxuICovXG5cblxuZnVuY3Rpb24gaW5pdChkZWJ1Zykge1xuICBkZWJ1Zy5pbnNwZWN0T3B0cyA9IHt9O1xuICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGV4cG9ydHMuaW5zcGVjdE9wdHMpO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgIGRlYnVnLmluc3BlY3RPcHRzW2tleXNbaV1dID0gZXhwb3J0cy5pbnNwZWN0T3B0c1trZXlzW2ldXTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vY29tbW9uJykoZXhwb3J0cyk7XG52YXIgZm9ybWF0dGVycyA9IG1vZHVsZS5leHBvcnRzLmZvcm1hdHRlcnM7XG4vKipcbiAqIE1hcCAlbyB0byBgdXRpbC5pbnNwZWN0KClgLCBhbGwgb24gYSBzaW5nbGUgbGluZS5cbiAqL1xuXG5mb3JtYXR0ZXJzLm8gPSBmdW5jdGlvbiAodikge1xuICB0aGlzLmluc3BlY3RPcHRzLmNvbG9ycyA9IHRoaXMudXNlQ29sb3JzO1xuICByZXR1cm4gdXRpbC5pbnNwZWN0KHYsIHRoaXMuaW5zcGVjdE9wdHMpLnJlcGxhY2UoL1xccypcXG5cXHMqL2csICcgJyk7XG59O1xuLyoqXG4gKiBNYXAgJU8gdG8gYHV0aWwuaW5zcGVjdCgpYCwgYWxsb3dpbmcgbXVsdGlwbGUgbGluZXMgaWYgbmVlZGVkLlxuICovXG5cblxuZm9ybWF0dGVycy5PID0gZnVuY3Rpb24gKHYpIHtcbiAgdGhpcy5pbnNwZWN0T3B0cy5jb2xvcnMgPSB0aGlzLnVzZUNvbG9ycztcbiAgcmV0dXJuIHV0aWwuaW5zcGVjdCh2LCB0aGlzLmluc3BlY3RPcHRzKTtcbn07XG5cbiJdfQ==