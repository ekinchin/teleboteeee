"use strict";

var _http = require("http");

var _https = require("https");

var _url = require("url");

var _events = require("events");

var _httpRequest = require("./httpRequest");

const eventer = new _events.EventEmitter();
const CMD = {
  setWebHook: 'setWebhook',
  getUpdates: 'getUpdates',
  sendMessage: 'sendMessage'
};
const token = '674082318:AAG4e5AXQu_SbJkYSVji4chwaiggtGrMLBc';
const telegramUrl = new _url.Url('https://api.telegram.org');
telegramUrl.pathname = `bot${token}/${CMD.sendMessage}`;

async function sendHttpRequest_(urlReq, headers, dataReq, method) {
  return new Promise((resolve, reject) => {
    const options = {
      hostname: urlReq.hostname,
      port: 443,
      path: urlReq.pathname + urlReq.search
    };
    options.method = method;
    options.headers = headers;

    const req = _https.https.request(options, res => {
      let answer = '';
      res.on('data', dataRes => {
        answer += dataRes;
      });
      res.on('end', () => {
        resolve(answer);
      });
      res.on('error', () => {
        reject(answer);
      });
    });

    if (options.headers !== undefined) {
      if ('Content-Type' in options.headers) {
        if (options.headers['Content-Type'] === 'application/json') {
          req.write(JSON.stringify(dataReq));
        }
      }
    }

    req.end();
  });
}

const yaApi = {
  getLocation: async city => {
    const geoUrl = new url.URL('https://geocode-maps.yandex.ru');
    geoUrl.pathname = '/1.x/';
    geoUrl.searchParams.append('format', 'json');
    geoUrl.searchParams.append('results', '1');
    geoUrl.searchParams.append('geocode', city);
    const geoLocation = await (0, _httpRequest.sendHttpRequest)(geoUrl, {}, null, 'GET');
    const geoLocationParse = JSON.parse(geoLocation);
    let cityParse;
    let lon;
    let lat;

    if (geoLocationParse.response.GeoObjectCollection.metaDataProperty.GeocoderResponseMetaData.found !== '0') {
      cityParse = geoLocationParse.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData.text;
      [lon, lat] = geoLocationParse.response.GeoObjectCollection.featureMember[0].GeoObject.Point.pos.split(' ');
    }

    return [cityParse || city, lon || 0, lat || 0];
  },
  getWeather: async (lon, lat) => {
    const weatherUrl = new url.URL('https://api.weather.yandex.ru');
    weatherUrl.pathname = '/v1/informers';
    weatherUrl.searchParams.append('lang', 'ru_RU');
    weatherUrl.searchParams.append('lat', lat);
    weatherUrl.searchParams.append('lon', lon);
    const weatherHeader = {
      'X-Yandex-API-Key': '40f0e52b-168d-40a4-ba38-0c2bf4d98726'
    };
    let weather = await (0, _httpRequest.sendHttpRequest)(weatherUrl, weatherHeader, null, 'GET');
    weather = JSON.parse(weather);
    return [weather.fact.temp, weather.fact.feels_like, weather.fact.wind_speed];
  }
};
const botCommands = {
  '/start': {
    descripion: 'Начать работу с ботом',
    handler: async (chatId, data) => {
      const answer = `Hello, ${data.message.from.first_name}`;
      await (0, _httpRequest.sendHttpRequest)(telegramUrl, {
        'Content-Type': 'application/json'
      }, {
        method: CMD.sendMessage,
        chat_id: chatId,
        text: answer
      }, 'POST');
    }
  },
  '/help': {
    descripion: 'Помощь',
    handler: async chatId => {
      const answer = '/start - поздороваться\n/weather - текущая погода\n/help - эта справка';
      await (0, _httpRequest.sendHttpRequest)(telegramUrl, {
        'Content-Type': 'application/json'
      }, {
        method: CMD.sendMessage,
        chat_id: chatId,
        text: answer
      }, 'POST');
    }
  },
  '/weather': {
    descripion: 'Погода',
    handler: async (chatId, data) => {
      let city = 'Tyumen';
      let lat = 57;
      let lon = 65;
      let answer = '';

      if (data.message.text.split(' ')[1] !== undefined) {
        [city, lon, lat] = await yaApi.getLocation(data.message.text.split(' ')[1]);
      }

      if (lon !== 0 || lat !== 0) {
        const [temp, tempFeel, wind] = await yaApi.getWeather(lon, lat);
        answer = `Погода в: ${city}\n` + `Текущая температура: ${temp}\n` + `Ощущается как: ${tempFeel}\n` + `Ветер: ${wind}`;
      } else {
        answer = 'Не удалось найти город';
      }

      await (0, _httpRequest.sendHttpRequest)(telegramUrl, {
        'Content-Type': 'application/json'
      }, {
        method: CMD.sendMessage,
        chat_id: chatId,
        text: answer
      }, 'POST');
    }
  },
  undefined: {
    descripion: 'Неизвестная команда',
    handler: async chatId => {
      const answer = 'Неизвестная команда, воспользуйтесь справкой /help';
      await (0, _httpRequest.sendHttpRequest)(telegramUrl, {
        'Content-Type': 'application/json'
      }, {
        method: CMD.sendMessage,
        chat_id: chatId,
        text: answer
      }, 'POST');
    }
  }
};

function reqParse(data) {
  const dataParse = JSON.parse(data);
  const entities = dataParse.message.entities[0] || '';

  if (entities.type === 'bot_command') {
    switch (dataParse.message.text.split(' ')[0].toLowerCase()) {
      case '/start':
      case '/help':
      case '/weather':
        eventer.emit(dataParse.message.text.split(' ')[0].toLowerCase(), dataParse.message.chat.id, dataParse);
        break;

      default:
        eventer.emit('undefined', dataParse.message.chat.id);
        break;
    }
  }

  return 0;
}

async function Server() {
  const server = _http.http.createServer();

  server.listen(process.env.PORT);
  server.on('request', (request, response) => {
    let requestData = '';
    request.on('data', data => {
      requestData += data;
    });
    request.on('end', () => {
      reqParse(requestData);
      response.end();
    });
  });
}

eventer.on('/weather', botCommands['/weather'].handler);
eventer.on('/start', botCommands['/start'].handler);
eventer.on('/help', botCommands['/help'].handler);
eventer.on('undefined', botCommands.undefined.handler);
const setWebHookUrl = new _url.Url('https://api.telegram.org/');
setWebHookUrl.pathname = `bot${token}${CMD.setWebHook}`;
setWebHookUrl.searchParams.append('url', 'https://teleboteeee.herokuapp.com/');
(0, _httpRequest.sendHttpRequest)(setWebHookUrl, {}, null, 'GET').then(Server);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJldmVudGVyIiwiRXZlbnRFbWl0dGVyIiwiQ01EIiwic2V0V2ViSG9vayIsImdldFVwZGF0ZXMiLCJzZW5kTWVzc2FnZSIsInRva2VuIiwidGVsZWdyYW1VcmwiLCJVcmwiLCJwYXRobmFtZSIsInNlbmRIdHRwUmVxdWVzdF8iLCJ1cmxSZXEiLCJoZWFkZXJzIiwiZGF0YVJlcSIsIm1ldGhvZCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwib3B0aW9ucyIsImhvc3RuYW1lIiwicG9ydCIsInBhdGgiLCJzZWFyY2giLCJyZXEiLCJodHRwcyIsInJlcXVlc3QiLCJyZXMiLCJhbnN3ZXIiLCJvbiIsImRhdGFSZXMiLCJ1bmRlZmluZWQiLCJ3cml0ZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlbmQiLCJ5YUFwaSIsImdldExvY2F0aW9uIiwiY2l0eSIsImdlb1VybCIsInVybCIsIlVSTCIsInNlYXJjaFBhcmFtcyIsImFwcGVuZCIsImdlb0xvY2F0aW9uIiwiZ2VvTG9jYXRpb25QYXJzZSIsInBhcnNlIiwiY2l0eVBhcnNlIiwibG9uIiwibGF0IiwicmVzcG9uc2UiLCJHZW9PYmplY3RDb2xsZWN0aW9uIiwibWV0YURhdGFQcm9wZXJ0eSIsIkdlb2NvZGVyUmVzcG9uc2VNZXRhRGF0YSIsImZvdW5kIiwiZmVhdHVyZU1lbWJlciIsIkdlb09iamVjdCIsIkdlb2NvZGVyTWV0YURhdGEiLCJ0ZXh0IiwiUG9pbnQiLCJwb3MiLCJzcGxpdCIsImdldFdlYXRoZXIiLCJ3ZWF0aGVyVXJsIiwid2VhdGhlckhlYWRlciIsIndlYXRoZXIiLCJmYWN0IiwidGVtcCIsImZlZWxzX2xpa2UiLCJ3aW5kX3NwZWVkIiwiYm90Q29tbWFuZHMiLCJkZXNjcmlwaW9uIiwiaGFuZGxlciIsImNoYXRJZCIsImRhdGEiLCJtZXNzYWdlIiwiZnJvbSIsImZpcnN0X25hbWUiLCJjaGF0X2lkIiwidGVtcEZlZWwiLCJ3aW5kIiwicmVxUGFyc2UiLCJkYXRhUGFyc2UiLCJlbnRpdGllcyIsInR5cGUiLCJ0b0xvd2VyQ2FzZSIsImVtaXQiLCJjaGF0IiwiaWQiLCJTZXJ2ZXIiLCJzZXJ2ZXIiLCJodHRwIiwiY3JlYXRlU2VydmVyIiwibGlzdGVuIiwicHJvY2VzcyIsImVudiIsIlBPUlQiLCJyZXF1ZXN0RGF0YSIsInNldFdlYkhvb2tVcmwiLCJ0aGVuIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBLE1BQU1BLE9BQU8sR0FBRyxJQUFJQyxvQkFBSixFQUFoQjtBQUVBLE1BQU1DLEdBQUcsR0FBRztBQUNWQyxFQUFBQSxVQUFVLEVBQUUsWUFERjtBQUVWQyxFQUFBQSxVQUFVLEVBQUUsWUFGRjtBQUdWQyxFQUFBQSxXQUFXLEVBQUU7QUFISCxDQUFaO0FBTUEsTUFBTUMsS0FBSyxHQUFHLCtDQUFkO0FBQ0EsTUFBTUMsV0FBVyxHQUFHLElBQUlDLFFBQUosQ0FBUSwwQkFBUixDQUFwQjtBQUNBRCxXQUFXLENBQUNFLFFBQVosR0FBd0IsTUFBS0gsS0FBTSxJQUFHSixHQUFHLENBQUNHLFdBQVksRUFBdEQ7O0FBRUEsZUFBZUssZ0JBQWYsQ0FBZ0NDLE1BQWhDLEVBQXdDQyxPQUF4QyxFQUFpREMsT0FBakQsRUFBMERDLE1BQTFELEVBQWtFO0FBQ2hFLFNBQU8sSUFBSUMsT0FBSixDQUFZLENBQUNDLE9BQUQsRUFBVUMsTUFBVixLQUFxQjtBQUN0QyxVQUFNQyxPQUFPLEdBQUc7QUFDZEMsTUFBQUEsUUFBUSxFQUFFUixNQUFNLENBQUNRLFFBREg7QUFFZEMsTUFBQUEsSUFBSSxFQUFFLEdBRlE7QUFHZEMsTUFBQUEsSUFBSSxFQUFFVixNQUFNLENBQUNGLFFBQVAsR0FBa0JFLE1BQU0sQ0FBQ1c7QUFIakIsS0FBaEI7QUFLQUosSUFBQUEsT0FBTyxDQUFDSixNQUFSLEdBQWlCQSxNQUFqQjtBQUNBSSxJQUFBQSxPQUFPLENBQUNOLE9BQVIsR0FBa0JBLE9BQWxCOztBQUVBLFVBQU1XLEdBQUcs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S0FBWCxFQUFrQixNQUFNO0FBQ3RCb0QsTUFBQUEsUUFBUSxDQUFDZ0IsV0FBRCxDQUFSO0FBQ0EvQyxNQUFBQSxRQUFRLENBQUNmLEdBQVQ7QUFDRCxLQUhEO0FBSUQsR0FURDtBQVVEOztBQUVEbEMsT0FBTyxDQUFDNEIsRUFBUixDQUFXLFVBQVgsRUFBdUJ5QyxXQUFXLENBQUMsVUFBRCxDQUFYLENBQXdCRSxPQUEvQztBQUNBdkUsT0FBTyxDQUFDNEIsRUFBUixDQUFXLFFBQVgsRUFBcUJ5QyxXQUFXLENBQUMsUUFBRCxDQUFYLENBQXNCRSxPQUEzQztBQUNBdkUsT0FBTyxDQUFDNEIsRUFBUixDQUFXLE9BQVgsRUFBb0J5QyxXQUFXLENBQUMsT0FBRCxDQUFYLENBQXFCRSxPQUF6QztBQUNBdkUsT0FBTyxDQUFDNEIsRUFBUixDQUFXLFdBQVgsRUFBd0J5QyxXQUFXLENBQUN2QyxTQUFaLENBQXNCeUMsT0FBOUM7QUFHQSxNQUFNMEIsYUFBYSxHQUFHLElBQUl6RixRQUFKLENBQVEsMkJBQVIsQ0FBdEI7QUFDQXlGLGFBQWEsQ0FBQ3hGLFFBQWQsR0FBMEIsTUFBS0gsS0FBTSxHQUFFSixHQUFHLENBQUNDLFVBQVcsRUFBdEQ7QUFDQThGLGFBQWEsQ0FBQ3hELFlBQWQsQ0FBMkJDLE1BQTNCLENBQ0UsS0FERixFQUVFLG9DQUZGO0FBS0Esa0NBQWdCdUQsYUFBaEIsRUFBK0IsRUFBL0IsRUFBbUMsSUFBbkMsRUFBeUMsS0FBekMsRUFBZ0RDLElBQWhELENBQXFEVixNQUFyRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGh0dHAgfSBmcm9tICdodHRwJztcbmltcG9ydCB7IGh0dHBzIH0gZnJvbSAnaHR0cHMnO1xuaW1wb3J0IHsgVXJsIH0gZnJvbSAndXJsJztcbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJ2V2ZW50cyc7XG5pbXBvcnQgeyBzZW5kSHR0cFJlcXVlc3QgfSBmcm9tICcuL2h0dHBSZXF1ZXN0JztcblxuY29uc3QgZXZlbnRlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuY29uc3QgQ01EID0ge1xuICBzZXRXZWJIb29rOiAnc2V0V2ViaG9vaycsXG4gIGdldFVwZGF0ZXM6ICdnZXRVcGRhdGVzJyxcbiAgc2VuZE1lc3NhZ2U6ICdzZW5kTWVzc2FnZScsXG59O1xuXG5jb25zdCB0b2tlbiA9ICc2NzQwODIzMTg6QUFHNGU1QVhRdV9TYkprWVNWamk0Y2h3YWlnZ3RHck1MQmMnO1xuY29uc3QgdGVsZWdyYW1VcmwgPSBuZXcgVXJsKCdodHRwczovL2FwaS50ZWxlZ3JhbS5vcmcnKTtcbnRlbGVncmFtVXJsLnBhdGhuYW1lID0gYGJvdCR7dG9rZW59LyR7Q01ELnNlbmRNZXNzYWdlfWA7XG5cbmFzeW5jIGZ1bmN0aW9uIHNlbmRIdHRwUmVxdWVzdF8odXJsUmVxLCBoZWFkZXJzLCBkYXRhUmVxLCBtZXRob2QpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgaG9zdG5hbWU6IHVybFJlcS5ob3N0bmFtZSxcbiAgICAgIHBvcnQ6IDQ0MyxcbiAgICAgIHBhdGg6IHVybFJlcS5wYXRobmFtZSArIHVybFJlcS5zZWFyY2gsXG4gICAgfTtcbiAgICBvcHRpb25zLm1ldGhvZCA9IG1ldGhvZDtcbiAgICBvcHRpb25zLmhlYWRlcnMgPSBoZWFkZXJzO1xuXG4gICAgY29uc3QgcmVxID0gaHR0cHMucmVxdWVzdChvcHRpb25zLCAocmVzKSA9PiB7XG4gICAgICBsZXQgYW5zd2VyID0gJyc7XG4gICAgICByZXMub24oJ2RhdGEnLCAoZGF0YVJlcykgPT4ge1xuICAgICAgICBhbnN3ZXIgKz0gZGF0YVJlcztcbiAgICAgIH0pO1xuICAgICAgcmVzLm9uKCdlbmQnLCAoKSA9PiB7XG4gICAgICAgIHJlc29sdmUoYW5zd2VyKTtcbiAgICAgIH0pO1xuICAgICAgcmVzLm9uKCdlcnJvcicsICgpID0+IHtcbiAgICAgICAgcmVqZWN0KGFuc3dlcik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBpZiAob3B0aW9ucy5oZWFkZXJzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmICgnQ29udGVudC1UeXBlJyBpbiBvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPT09ICdhcHBsaWNhdGlvbi9qc29uJykge1xuICAgICAgICAgIHJlcS53cml0ZShKU09OLnN0cmluZ2lmeShkYXRhUmVxKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmVxLmVuZCgpO1xuICB9KTtcbn1cblxuY29uc3QgeWFBcGkgPSB7XG4gIGdldExvY2F0aW9uOiBhc3luYyAoY2l0eSkgPT4ge1xuICAgIGNvbnN0IGdlb1VybCA9IG5ldyB1cmwuVVJMKCdodHRwczovL2dlb2NvZGUtbWFwcy55YW5kZXgucnUnKTtcbiAgICBnZW9VcmwucGF0aG5hbWUgPSAnLzEueC8nO1xuICAgIGdlb1VybC5zZWFyY2hQYXJhbXMuYXBwZW5kKCdmb3JtYXQnLCAnanNvbicpO1xuICAgIGdlb1VybC5zZWFyY2hQYXJhbXMuYXBwZW5kKCdyZXN1bHRzJywgJzEnKTtcbiAgICBnZW9Vcmwuc2VhcmNoUGFyYW1zLmFwcGVuZCgnZ2VvY29kZScsIGNpdHkpO1xuXG4gICAgY29uc3QgZ2VvTG9jYXRpb24gPSBhd2FpdCBzZW5kSHR0cFJlcXVlc3QoZ2VvVXJsLCB7fSwgbnVsbCwgJ0dFVCcpO1xuICAgIGNvbnN0IGdlb0xvY2F0aW9uUGFyc2UgPSBKU09OLnBhcnNlKGdlb0xvY2F0aW9uKTtcbiAgICBsZXQgY2l0eVBhcnNlO1xuICAgIGxldCBsb247XG4gICAgbGV0IGxhdDtcbiAgICBpZiAoXG4gICAgICBnZW9Mb2NhdGlvblBhcnNlLnJlc3BvbnNlLkdlb09iamVjdENvbGxlY3Rpb25cbiAgICAgICAgLm1ldGFEYXRhUHJvcGVydHkuR2VvY29kZXJSZXNwb25zZU1ldGFEYXRhXG4gICAgICAgIC5mb3VuZCAhPT0gJzAnXG4gICAgKSB7XG4gICAgICBjaXR5UGFyc2UgPSBnZW9Mb2NhdGlvblBhcnNlLnJlc3BvbnNlLkdlb09iamVjdENvbGxlY3Rpb24uZmVhdHVyZU1lbWJlclswXVxuICAgICAgICAuR2VvT2JqZWN0Lm1ldGFEYXRhUHJvcGVydHkuR2VvY29kZXJNZXRhRGF0YS50ZXh0O1xuICAgICAgW2xvbiwgbGF0XSA9IGdlb0xvY2F0aW9uUGFyc2UucmVzcG9uc2UuR2VvT2JqZWN0Q29sbGVjdGlvbi5mZWF0dXJlTWVtYmVyWzBdLkdlb09iamVjdC5Qb2ludC5wb3Muc3BsaXQoJyAnKTtcbiAgICB9XG4gICAgcmV0dXJuIFtjaXR5UGFyc2UgfHwgY2l0eSwgbG9uIHx8IDAsIGxhdCB8fCAwXTtcbiAgfSxcbiAgZ2V0V2VhdGhlcjogYXN5bmMgKGxvbiwgbGF0KSA9PiB7XG4gICAgY29uc3Qgd2VhdGhlclVybCA9IG5ldyB1cmwuVVJMKCdodHRwczovL2FwaS53ZWF0aGVyLnlhbmRleC5ydScpO1xuICAgIHdlYXRoZXJVcmwucGF0aG5hbWUgPSAnL3YxL2luZm9ybWVycyc7XG4gICAgd2VhdGhlclVybC5zZWFyY2hQYXJhbXMuYXBwZW5kKCdsYW5nJywgJ3J1X1JVJyk7XG4gICAgd2VhdGhlclVybC5zZWFyY2hQYXJhbXMuYXBwZW5kKCdsYXQnLCBsYXQpO1xuICAgIHdlYXRoZXJVcmwuc2VhcmNoUGFyYW1zLmFwcGVuZCgnbG9uJywgbG9uKTtcbiAgICBjb25zdCB3ZWF0aGVySGVhZGVyID0geyAnWC1ZYW5kZXgtQVBJLUtleSc6ICc0MGYwZTUyYi0xNjhkLTQwYTQtYmEzOC0wYzJiZjRkOTg3MjYnIH07XG5cbiAgICBsZXQgd2VhdGhlciA9IGF3YWl0IHNlbmRIdHRwUmVxdWVzdCh3ZWF0aGVyVXJsLCB3ZWF0aGVySGVhZGVyLCBudWxsLCAnR0VUJyk7XG4gICAgd2VhdGhlciA9IEpTT04ucGFyc2Uod2VhdGhlcik7XG4gICAgcmV0dXJuIFt3ZWF0aGVyLmZhY3QudGVtcCwgd2VhdGhlci5mYWN0LmZlZWxzX2xpa2UsIHdlYXRoZXIuZmFjdC53aW5kX3NwZWVkXTtcbiAgfSxcbn07XG5cbmNvbnN0IGJvdENvbW1hbmRzID0ge1xuICAnL3N0YXJ0Jzoge1xuICAgIGRlc2NyaXBpb246ICfQndCw0YfQsNGC0Ywg0YDQsNCx0L7RgtGDINGBINCx0L7RgtC+0LwnLFxuICAgIGhhbmRsZXI6XG4gICAgYXN5bmMgKGNoYXRJZCwgZGF0YSkgPT4ge1xuICAgICAgY29uc3QgYW5zd2VyID0gYEhlbGxvLCAke2RhdGEubWVzc2FnZS5mcm9tLmZpcnN0X25hbWV9YDtcbiAgICAgIGF3YWl0IHNlbmRIdHRwUmVxdWVzdCh0ZWxlZ3JhbVVybCwgeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sIHsgbWV0aG9kOiBDTUQuc2VuZE1lc3NhZ2UsIGNoYXRfaWQ6IGNoYXRJZCwgdGV4dDogYW5zd2VyIH0sICdQT1NUJyk7XG4gICAgfSxcbiAgfSxcbiAgJy9oZWxwJzoge1xuICAgIGRlc2NyaXBpb246ICfQn9C+0LzQvtGJ0YwnLFxuICAgIGhhbmRsZXI6XG4gICAgYXN5bmMgKGNoYXRJZCkgPT4ge1xuICAgICAgY29uc3QgYW5zd2VyID0gJy9zdGFydCAtINC/0L7Qt9C00L7RgNC+0LLQsNGC0YzRgdGPXFxuL3dlYXRoZXIgLSDRgtC10LrRg9GJ0LDRjyDQv9C+0LPQvtC00LBcXG4vaGVscCAtINGN0YLQsCDRgdC/0YDQsNCy0LrQsCc7XG4gICAgICBhd2FpdCBzZW5kSHR0cFJlcXVlc3QodGVsZWdyYW1VcmwsIHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LCB7IG1ldGhvZDogQ01ELnNlbmRNZXNzYWdlLCBjaGF0X2lkOiBjaGF0SWQsIHRleHQ6IGFuc3dlciB9LCAnUE9TVCcpO1xuICAgIH0sXG4gIH0sXG4gICcvd2VhdGhlcic6IHtcbiAgICBkZXNjcmlwaW9uOiAn0J/QvtCz0L7QtNCwJyxcbiAgICBoYW5kbGVyOlxuICAgIGFzeW5jIChjaGF0SWQsIGRhdGEpID0+IHtcbiAgICAgIGxldCBjaXR5ID0gJ1R5dW1lbic7XG4gICAgICBsZXQgbGF0ID0gNTc7XG4gICAgICBsZXQgbG9uID0gNjU7XG4gICAgICBsZXQgYW5zd2VyID0gJyc7XG4gICAgICBpZiAoZGF0YS5tZXNzYWdlLnRleHQuc3BsaXQoJyAnKVsxXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIFtjaXR5LCBsb24sIGxhdF0gPSBhd2FpdCB5YUFwaS5nZXRMb2NhdGlvbihkYXRhLm1lc3NhZ2UudGV4dC5zcGxpdCgnICcpWzFdKTtcbiAgICAgIH1cbiAgICAgIGlmIChsb24gIT09IDAgfHwgbGF0ICE9PSAwKSB7XG4gICAgICAgIGNvbnN0IFt0ZW1wLCB0ZW1wRmVlbCwgd2luZF0gPSBhd2FpdCB5YUFwaS5nZXRXZWF0aGVyKGxvbiwgbGF0KTtcbiAgICAgICAgYW5zd2VyID0gYNCf0L7Qs9C+0LTQsCDQsjogJHtjaXR5fVxcbmBcbiAgICAgICAgKyBg0KLQtdC60YPRidCw0Y8g0YLQtdC80L/QtdGA0LDRgtGD0YDQsDogJHt0ZW1wfVxcbmBcbiAgICAgICAgKyBg0J7RidGD0YnQsNC10YLRgdGPINC60LDQujogJHt0ZW1wRmVlbH1cXG5gXG4gICAgICAgICsgYNCS0LXRgtC10YA6ICR7d2luZH1gO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYW5zd2VyID0gJ9Cd0LUg0YPQtNCw0LvQvtGB0Ywg0L3QsNC50YLQuCDQs9C+0YDQvtC0JztcbiAgICAgIH1cbiAgICAgIGF3YWl0IHNlbmRIdHRwUmVxdWVzdCh0ZWxlZ3JhbVVybCwgeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sIHsgbWV0aG9kOiBDTUQuc2VuZE1lc3NhZ2UsIGNoYXRfaWQ6IGNoYXRJZCwgdGV4dDogYW5zd2VyIH0sICdQT1NUJyk7XG4gICAgfSxcbiAgfSxcbiAgdW5kZWZpbmVkOiB7XG4gICAgZGVzY3JpcGlvbjogJ9Cd0LXQuNC30LLQtdGB0YLQvdCw0Y8g0LrQvtC80LDQvdC00LAnLFxuICAgIGhhbmRsZXI6XG4gICAgYXN5bmMgKGNoYXRJZCkgPT4ge1xuICAgICAgY29uc3QgYW5zd2VyID0gJ9Cd0LXQuNC30LLQtdGB0YLQvdCw0Y8g0LrQvtC80LDQvdC00LAsINCy0L7RgdC/0L7Qu9GM0LfRg9C50YLQtdGB0Ywg0YHQv9GA0LDQstC60L7QuSAvaGVscCc7XG4gICAgICBhd2FpdCBzZW5kSHR0cFJlcXVlc3QodGVsZWdyYW1VcmwsIHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LCB7IG1ldGhvZDogQ01ELnNlbmRNZXNzYWdlLCBjaGF0X2lkOiBjaGF0SWQsIHRleHQ6IGFuc3dlciB9LCAnUE9TVCcpO1xuICAgIH0sXG4gIH0sXG59O1xuXG5mdW5jdGlvbiByZXFQYXJzZShkYXRhKSB7XG4gIGNvbnN0IGRhdGFQYXJzZSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gIGNvbnN0IGVudGl0aWVzID0gZGF0YVBhcnNlLm1lc3NhZ2UuZW50aXRpZXNbMF0gfHwgJyc7XG4gIGlmIChlbnRpdGllcy50eXBlID09PSAnYm90X2NvbW1hbmQnKSB7XG4gICAgc3dpdGNoIChkYXRhUGFyc2UubWVzc2FnZS50ZXh0LnNwbGl0KCcgJylbMF0udG9Mb3dlckNhc2UoKSkge1xuICAgICAgY2FzZSAnL3N0YXJ0JzpcbiAgICAgIGNhc2UgJy9oZWxwJzpcbiAgICAgIGNhc2UgJy93ZWF0aGVyJzpcbiAgICAgICAgZXZlbnRlci5lbWl0KGRhdGFQYXJzZS5tZXNzYWdlLnRleHQuc3BsaXQoJyAnKVswXS50b0xvd2VyQ2FzZSgpLCBkYXRhUGFyc2UubWVzc2FnZS5jaGF0LmlkLCBkYXRhUGFyc2UpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGV2ZW50ZXIuZW1pdCgndW5kZWZpbmVkJywgZGF0YVBhcnNlLm1lc3NhZ2UuY2hhdC5pZCk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICByZXR1cm4gMDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gU2VydmVyKCkge1xuICBjb25zdCBzZXJ2ZXIgPSBodHRwLmNyZWF0ZVNlcnZlcigpO1xuICBzZXJ2ZXIubGlzdGVuKHByb2Nlc3MuZW52LlBPUlQpO1xuICBzZXJ2ZXIub24oJ3JlcXVlc3QnLCAocmVxdWVzdCwgcmVzcG9uc2UpID0+IHtcbiAgICBsZXQgcmVxdWVzdERhdGEgPSAnJztcbiAgICByZXF1ZXN0Lm9uKCdkYXRhJywgKGRhdGEpID0+IHtcbiAgICAgIHJlcXVlc3REYXRhICs9IGRhdGE7XG4gICAgfSk7XG4gICAgcmVxdWVzdC5vbignZW5kJywgKCkgPT4ge1xuICAgICAgcmVxUGFyc2UocmVxdWVzdERhdGEpO1xuICAgICAgcmVzcG9uc2UuZW5kKCk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5ldmVudGVyLm9uKCcvd2VhdGhlcicsIGJvdENvbW1hbmRzWycvd2VhdGhlciddLmhhbmRsZXIpO1xuZXZlbnRlci5vbignL3N0YXJ0JywgYm90Q29tbWFuZHNbJy9zdGFydCddLmhhbmRsZXIpO1xuZXZlbnRlci5vbignL2hlbHAnLCBib3RDb21tYW5kc1snL2hlbHAnXS5oYW5kbGVyKTtcbmV2ZW50ZXIub24oJ3VuZGVmaW5lZCcsIGJvdENvbW1hbmRzLnVuZGVmaW5lZC5oYW5kbGVyKTtcblxuXG5jb25zdCBzZXRXZWJIb29rVXJsID0gbmV3IFVybCgnaHR0cHM6Ly9hcGkudGVsZWdyYW0ub3JnLycpO1xuc2V0V2ViSG9va1VybC5wYXRobmFtZSA9IGBib3Qke3Rva2VufSR7Q01ELnNldFdlYkhvb2t9YDtcbnNldFdlYkhvb2tVcmwuc2VhcmNoUGFyYW1zLmFwcGVuZChcbiAgJ3VybCcsXG4gICdodHRwczovL3RlbGVib3RlZWVlLmhlcm9rdWFwcC5jb20vJyxcbik7XG5cbnNlbmRIdHRwUmVxdWVzdChzZXRXZWJIb29rVXJsLCB7fSwgbnVsbCwgJ0dFVCcpLnRoZW4oU2VydmVyKTsiXX0=